FROM ubuntu:22.04

RUN apt update -y

RUN apt install -y build-essential libcunit1-dev libudev-dev socat

COPY app/ /app
RUN chown -R root:root /app
RUN chmod -R 555 /app

WORKDIR /app
RUN useradd ctf
EXPOSE 8000

ENTRYPOINT ["socat", "TCP-LISTEN:8000,reuseaddr,fork,nodelay,su=ctf", "EXEC:'./run.sh'"]